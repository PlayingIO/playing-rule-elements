<link rel="import" href="../../mostly-elements/behaviors/mostly-func-behavior.html">

<script>
  var Playing = Playing || {};

  /**
   * @polymerBehavior Playing.RuleBehavior
   */
  Playing.RuleBehavior = [Mostly.FuncBehavior, {

    properties: {
    },

    _selectMetric(target, id) {
      if (this.metrics) {
        this.set(target, this.findById(this.metrics, id));
      } else {
        this.$.metrics.get().then(response => {
          this.set(target, this.findById(response.data, id));
        });
      }
    },

    _getMetricName(metrics, id) {
      if (metrics) {
        var metric = this.findById(metrics, id);
        if (metric) return metric.name;
      }
      return id;
    },

    _getMetricConstraints(id, field) {
      if (this.metrics) {
        var index = this.metrics.findIndex(m => m.id === id);
        if (index >= 0) {
          var constraints = this.metrics[index].constraints;
          return constraints && constraints[field];
        }
      }
      return [];
    }
  }];
</script>
